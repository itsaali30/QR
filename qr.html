<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>QRBR â€” QR & Barcode Studio</title>

  <!-- Bootstrap 5 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Font Awesome -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

  <!-- Vue / Vuex / Router -->
  <script src="https://unpkg.com/vue@3"></script>
  <script src="https://unpkg.com/vuex@4"></script>
  <script src="https://unpkg.com/vue-router@4"></script>

  <!-- JsBarcode and QRCode -->
  <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

  <style>
    :root{
      --primary: #0d6efd;
      --bg: #f5f7fb;
      --card-radius: 14px;
      --glass: rgba(255,255,255,0.92);
      --muted: #6b7280;
    }

    html,body { height:100%; margin:0; background: var(--bg); font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; color:#0f1724; }

    /* Background YouTube (desktop) */
    .bg-youtube {
      position: fixed;
      inset: 0;
      z-index: -2;
      overflow: hidden;
      pointer-events: none; /* non-interactive */
      opacity: 0.06;
      filter: blur(0.8px) saturate(0.8);
      display: none;
    }
    @media (min-width: 900px) {
      .bg-youtube { display:block; }
    }
    .bg-youtube iframe {
      width: 140%;
      height: 140%;
      transform: translate(-10%, -10%);
      border: 0;
    }

    /* NAVBAR */
    .app-navbar { backdrop-filter: blur(6px); background: var(--glass); border-bottom: 1px solid rgba(0,0,0,0.04); box-shadow: 0 6px 18px rgba(12, 13, 14, .04); }
    .brand-title { font-weight:700; font-size:1.05rem; }

    .offcanvas-start.custom-drawer { width: 300px; max-width: 85%; }

    /* layout */
    .main-container { max-width: 1100px; margin: 22px auto; padding: 12px; padding-bottom: 160px; }
    .card-ui { border-radius: var(--card-radius); box-shadow: 0 8px 30px rgba(15,23,42,0.04); }

    /* carousel images */
    .home-carousel .carousel-item img { width:100%; height:420px; object-fit:cover; border-radius:10px; }
    @media (max-width:900px) { .home-carousel .carousel-item img { height:300px; } }
    @media (max-width:520px) { .home-carousel .carousel-item img { height:220px; } }

    /* preview */
    .preview-box { text-align:center !important; }
    .qr-preview-center { text-align: center !important; }
    #qrcode, #qrcode-bin { margin: 8px auto; display:block; }
    svg[id^="barcode"] { display:block; margin: 8px auto; max-width:100%; height:auto; }

    /* sticky footer */
    .sticky-footer { position: fixed; left:0; right:0; bottom:0; height:92px; background: var(--glass); border-top:1px solid rgba(0,0,0,0.06); display:flex; justify-content:center; align-items:center; z-index:1200; padding:8px; }
    .sticky-footer .iframe-wrap { width:340px; height:74px; border-radius:10px; overflow:hidden; box-shadow:0 8px 30px rgba(15,23,42,0.06); border:1px solid rgba(0,0,0,0.04); }
    @media (min-width:992px) { .sticky-footer .iframe-wrap { width:560px; height:80px; } }

    .num-btn { min-width:48px; min-height:44px; border-radius:10px; font-weight:700; }

    /* small-screen spacing to avoid footer overlap */
    @media (max-height:600px) { .main-container { padding-bottom:220px; } }

    /* subtle helpers */
    .muted { color: var(--muted); }
    .controls-row { gap:12px; display:flex; flex-wrap:wrap; align-items:center; }

    /* fixed blue preview wrapper */
    .bg-blue-box { background:#482680; border-radius:10px; padding:8px; }

    /* full-screen modal content styling */
    .barcode-fullscreen-content {
      background: #351a63; /* your purple */
  background-image: radial-gradient(rgba(255,255,255,0.2) 0.5px, transparent 0.5px);
  background-size: 6px 6px; /* small dots */
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .barcode-fullscreen-content svg {
      transform: rotate(90deg);
      width: 100%;
      height: auto;
      max-width: auto;
    }
  </style>
</head>
<body>
  <div id="app">
    <!-- Background YouTube (muted + autoplay + loop) -->
    

    <!-- NAVBAR -->
    <header class="app-navbar sticky-top">
      <div class="container">
        <div class="d-flex align-items-center justify-content-between py-2">
          <div class="d-flex align-items-center gap-2">
            <button class="btn p-0" data-bs-toggle="offcanvas" data-bs-target="#leftDrawer" aria-controls="leftDrawer">
              <div style="width:44px;height:44px;border-radius:10px;background:white;display:flex;align-items:center;justify-content:center;border:1px solid rgba(0,0,0,0.06);">
                <i class="fa-solid fa-bars"></i>
              </div>
            </button>
            <a class="text-decoration-none ms-2 d-none d-md-inline-block text-muted" href="#/"><i class="fa-solid fa-house-chimney"></i></a>
          </div>

          <div class="text-center flex-grow-1">
            <div class="brand-title">ðŸ“¦ QRBR</div>
            <div class="text-muted small d-none d-md-block">studio</div>
          </div>

          <div class="d-flex align-items-center gap-2">
            <nav class="d-flex gap-2">
              <router-link to="/" class="nav-link px-2" exact>Home</router-link>
              <router-link to="/bin" class="nav-link px-2">Bin</router-link>
              <router-link to="/about" class="nav-link px-2">About</router-link>
            </nav>
            <button class="btn btn-outline-secondary d-none d-lg-inline-flex align-items-center"><i class="fa-solid fa-download me-2"></i>Export</button>
          </div>
        </div>
      </div>
    </header>

    <!-- OFFCANVAS LEFT -->
    <div class="offcanvas offcanvas-start custom-drawer" tabindex="-1" id="leftDrawer" aria-labelledby="leftDrawerLabel">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="leftDrawerLabel"><i class="fa-solid fa-clipboard-list me-2"></i>Menu</h5>
        <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
      </div>
      <div class="offcanvas-body">
        <div class="list-group mb-3">
          <router-link to="/" class="list-group-item list-group-item-action"> <i class="fa-solid fa-qrcode me-2"></i>Home - Gallery</router-link>
          <router-link to="/bin" class="list-group-item list-group-item-action"> <i class="fa-solid fa-box-open me-2"></i>Bin Codes</router-link>
          <router-link to="/about" class="list-group-item list-group-item-action"> <i class="fa-solid fa-circle-info me-2"></i>About</router-link>
        </div>

        <h6 class="small text-uppercase text-muted mb-2">Quick Tools</h6>
        <div class="d-grid gap-2 mb-3">
          <button class="btn btn-outline-primary btn-sm"><i class="fa-solid fa-print me-2"></i>Print QR</button>
          <button class="btn btn-outline-success btn-sm"><i class="fa-solid fa-share-nodes me-2"></i>Share</button>
        </div>

        <div class="small text-muted">Made by <i class="fa-solid fa-heart text-danger"></i> â€” Rider</div>
      </div>
    </div>

    <!-- MAIN -->
    <main class="main-container">
      <div class="row gy-3">
        <div class="col-12">
          <div class="router-card card-ui p-3">
            <router-view></router-view>
          </div>
        </div>
      </div>
    </main>

    <!-- STICKY FOOTER: fixed bottom iframe -->
    

    <!-- FULLSCREEN BARCODE MODAL (single modal reused by Home) -->
    <div class="modal fade" id="fullscreenBarcodeModal" tabindex="-1" aria-hidden="true" ref="fsModal">
      <div class="modal-dialog modal-fullscreen">
        <div class="modal-content barcode-fullscreen-content">
          <button type="button" class="btn-close btn-close-white position-absolute top-0 end-0 m-3" data-bs-dismiss="modal" aria-label="Close"></button>
          <!-- full-screen rotated SVG will be injected here -->
          <svg id="barcode-fullscreen-svg" ref="fullSvg"></svg>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- App Script -->
  <script>
    (function () {
      const { createApp, ref, computed, watch, onMounted, nextTick } = Vue;
      const { createStore } = Vuex;
      const { createRouter, createWebHashHistory } = VueRouter;

      // -----------------------
      // Store (global state)
      // -----------------------
      const store = createStore({
        state() {
          return {
            inputText: '',
            selectedOption: 'HYD_SRB',
            finalText: ''
          };
        },
        mutations: {
          setInputText(state, val) { state.inputText = val; },
          setSelectedOption(state, val) { state.selectedOption = val; },
          setFinalText(state, val) { state.finalText = val; }
        }
      });

      // -----------------------
      // Utility: debounce
      // -----------------------
      function debounce(fn, wait = 250) {
        let t;
        return (...args) => {
          clearTimeout(t);
          t = setTimeout(() => fn(...args), wait);
        };
      }

      // -----------------------
      // HOME component
      // -----------------------
      const Home = {
        template: `
        <div>
          <div class="row gy-3">
            <!-- Controls & preview -->
            <div class="col-12 col-lg-6">
              
              <div class="mb-2">
                <label class="form-label small">QR & Barcode Generator</label>
                <select class="form-select form-select-sm" v-model="selectedOption">
                  <option v-for="opt in options" :key="opt" :value="opt">{{ opt || '(empty)' }}</option>
                </select>
              </div>

              <div class="mb-2">
                <label class="form-label small">Input text</label>
                <input class="form-control form-control-lg" v-model="inputText" placeholder="Enter text (e.g. 12345)" />
              </div>

              <div class="controls-row mt-2">
                <button class="btn btn-primary" @click="copyFinal" :disabled="!computedFinalText"><i class="fa-regular fa-copy me-2"></i>Copy</button>
                <button class="btn btn-outline-secondary" @click="clearAll"><i class="fa-solid fa-eraser me-2"></i>Clear</button>
                <div class="btn-group ms-auto">
                  <button class="btn btn-success" @click="downloadQr" :disabled="!qrPresent"><i class="fa-solid fa-download me-2"></i>Download QR</button>
                  <button class="btn btn-outline-dark" @click="downloadBarcode" :disabled="!barcodePresent"><i class="fa-solid fa-download me-2"></i>Download Barcode</button>
                </div>
              </div>

              <div class="mt-3 small text-muted">
                <strong>Final text:</strong> <span class="fw-semibold">{{ computedFinalText || 'â€”' }}</span>
              </div>
            </div>

            <!-- Preview -->
            <div class="col-12 col-lg-6">
              <div class="bg-blue-box">
                <div class="border rounded-3 p-3 bg-white preview-box">
                  <div class="d-flex justify-content-between align-items-center mb-2">
                    <h6 class="mb-0">Preview</h6>
                    <button class="btn btn-sm btn-dark" @click="openFullscreen"><i class="fa-solid fa-up-right-and-down-left-from-center me-1"></i>Full Screen</button>
                  </div>
                  <div class="d-flex flex-column align-items-center">
                    <div ref="qrcodeWrap" id="qrcode" style="min-height:120px"></div>
                    <svg ref="barcodeSvg" id="barcode-visual"></svg>
                    <div class="mt-2 small muted">CODE128 â€” best for scanners</div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Carousel gallery -->
            <div class="col-12">
              <div class="mt-3 p-3 bg-white rounded-3 card-ui">
                <div class="d-flex justify-content-between align-items-center mb-3">
                  <div>
                    <h5 class="mb-0">Gallery</h5>
                    <small class="text-muted">Auto sliding â€¢ swipeable</small>
                  </div>
                  <div>
                    <button class="btn btn-sm btn-outline-secondary me-1" data-bs-target="#homeCarousel" data-bs-slide="prev"><i class="fa-solid fa-chevron-left"></i></button>
                    <button class="btn btn-sm btn-outline-secondary" data-bs-target="#homeCarousel" data-bs-slide="next"><i class="fa-solid fa-chevron-right"></i></button>
                  </div>
                </div>

                <div id="homeCarousel" class="carousel slide home-carousel" data-bs-ride="carousel" data-bs-interval="3000">
                  <div class="carousel-indicators">
                    <button type="button" data-bs-target="#homeCarousel" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
                    <button type="button" data-bs-target="#homeCarousel" data-bs-slide-to="1" aria-label="Slide 2"></button>
                    <button type="button" data-bs-target="#homeCarousel" data-bs-slide-to="2" aria-label="Slide 3"></button>
                    <button type="button" data-bs-target="#homeCarousel" data-bs-slide-to="3" aria-label="Slide 4"></button>
                  </div>

                  <div class="carousel-inner rounded-3">
                    <div class="carousel-item active">
                      <img src="https://res.cloudinary.com/mandmshop/image/upload/v1762628206/IMG-20251109-WA0001_pqz82h.jpg" class="d-block w-100" alt="1">
                    </div>
                    <div class="carousel-item">
                      <img src="https://res.cloudinary.com/mandmshop/image/upload/v1762628444/IMG-20251109-WA0000_blnqcp.jpg" class="d-block w-100" alt="2">
                    </div>
                    <div class="carousel-item">
                      <img src="https://res.cloudinary.com/mandmshop/image/upload/v1752402615/IMG_20250713_155653_pal2de.jpg" class="d-block w-100" alt="3">
                    </div>
                    <div class="carousel-item">
                      <img src="https://res.cloudinary.com/mandmshop/image/upload/v1761308356/IMG-20251024-WA0013_serib8.jpg" class="d-block w-100" alt="4">
                    </div>
                  </div>

                  <button class="carousel-control-prev" type="button" data-bs-target="#homeCarousel" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Previous</span>
                  </button>
                  <button class="carousel-control-next" type="button" data-bs-target="#homeCarousel" data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Next</span>
                  </button>
                </div>

              </div>
            </div>

          </div>
          <div class="bg-youtube" aria-hidden="true">
      <iframe src="https://www.youtube.com/embed/WymKNMXDEpI?autoplay=1&mute=1&controls=0&loop=1&playlist=WymKNMXDEpI&rel=0&showinfo=0" allow="autoplay; encrypted-media" title="Background"></iframe>
    </div>
        </div>
        `,
        setup() {
          // refs
          const qrcodeWrap = ref(null);
          const barcodeSvg = ref(null);
          const fullSvg = ref(null); // modal svg ref will be wired later via DOM query
          const fsModalRef = ref(null);

          // store bindings
          const inputText = computed({
            get: () => store.state.inputText,
            set: (v) => store.commit('setInputText', v)
          });
          const selectedOption = computed({
            get: () => store.state.selectedOption,
            set: (v) => store.commit('setSelectedOption', v)
          });
          const computedFinalText = computed(() => (selectedOption.value || '') + (inputText.value || ''));

          // local flags
          const qrPresent = ref(false);
          const barcodePresent = ref(false);

          // options
          const options = [
            'HYD_SRB', 'ZEP_SRB_', '08_SRB_','09_SRB_','10_SRB_','11_SRB_','12_SRB_','13_SRB_',
            'HYD_RB', '', 'HYD_IB','ZEP_IB_','08_IB_', '09_IB_','10_IB_',
            'ZEP_RB_', 'ZEP_MIB_','08_MIB_', '09_MIB_', '10_MIB_', 'ZEP_IB',
             '08_RB_','09_RB_','10_RB_',
          ];

          // generate QR into DOM element using qrcode.js
          function renderQRCode(text) {
            const el = qrcodeWrap.value;
            if (!el) return;
            el.innerHTML = '';
            if (!text) { qrPresent.value = false; return; }
            new QRCode(el, {
              text: text,
              width: Math.min(260, Math.max(140, window.innerWidth * 0.24)),
              height: Math.min(260, Math.max(140, window.innerWidth * 0.24)),
              correctLevel: QRCode.CorrectLevel.H
            });
            qrPresent.value = true;
          }

          // render barcode using JsBarcode
          function renderBarcode(text) {
            const svg = barcodeSvg.value;
            if (!svg) return;
            if (!text) {
              svg.innerHTML = '';
              barcodePresent.value = false;
              return;
            }
            try {
              JsBarcode(svg, text, {
                format: 'CODE128',
                displayValue: true,
                lineColor: '#000',
                width: 2,
                height: 60,
                margin: 6
              });
              barcodePresent.value = true;
            } catch (e) {
              barcodePresent.value = false;
            }
          }

          // Debounced combined update
          const updatePreviews = debounce(async () => {
            await nextTick();
            const v = computedFinalText.value;
            renderQRCode(v);
            renderBarcode(v);
          }, 220);

          // watch computedFinalText
          watch(computedFinalText, () => updatePreviews(), { immediate: true });

          onMounted(() => {
            // cache modal refs (modal is outside component template)
            fsModalRef.value = document.getElementById('fullscreenBarcodeModal');
            fullSvg.value = document.getElementById('barcode-fullscreen-svg');
            updatePreviews();
          });

          // copy final
          const copyFinal = async () => {
            const text = computedFinalText.value || '';
            if (!text) return alert('Nothing to copy');
            try {
              await navigator.clipboard.writeText(text);
              alert('Copied: ' + text);
            } catch (e) {
              const ta = document.createElement('textarea');
              ta.value = text;
              document.body.appendChild(ta);
              ta.select();
              try { document.execCommand('copy'); alert('Copied: ' + text); } catch { alert('Copy failed'); }
              ta.remove();
            }
          };

          // clear
          const clearAll = () => {
            store.commit('setInputText', '');
            store.commit('setSelectedOption', options[0] || '');
            store.commit('setFinalText', '');
            if (qrcodeWrap.value) qrcodeWrap.value.innerHTML = '';
            if (barcodeSvg.value) barcodeSvg.value.innerHTML = '';
          };

          // download QR (PNG)
          const downloadQr = () => {
            const el = qrcodeWrap.value;
            if (!el) { alert('QR not found'); return; }
            const img = el.querySelector('img') || el.querySelector('canvas');
            if (img && (img.src || img.toDataURL)) {
              const href = img.src || img.toDataURL('image/png');
              const a = document.createElement('a');
              a.href = href;
              a.download = (computedFinalText.value || 'qr') + '.png';
              a.click();
            } else {
              alert('Unable to export QR yet. Try again after it appears.');
            }
          };

          // download barcode as SVG
          const downloadBarcode = () => {
            const svgEl = barcodeSvg.value;
            if (!svgEl) { alert('Barcode not found'); return; }
            const svgText = svgEl.outerHTML;
            const blob = new Blob([svgText], { type: 'image/svg+xml' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = (computedFinalText.value || 'barcode') + '.svg';
            a.click();
            URL.revokeObjectURL(url);
          };

          // Fullscreen: copy barcode SVG into modal, show modal
          const openFullscreen = () => {
            try {
              // copy current barcode svg markup into the fullscreen svg
              if (barcodeSvg.value && fullSvg.value) {
                fullSvg.value.innerHTML = barcodeSvg.value.innerHTML;
                // if barcode has width/height attributes, adjust viewBox or style
                // remove id duplicates
                fullSvg.value.querySelectorAll('[id]').forEach(el => el.removeAttribute('id'));
              }

              const modalDom = fsModalRef.value;
              if (!modalDom) return;
              const modal = new bootstrap.Modal(modalDom);
              modal.show();
            } catch (e) {
              console.error(e);
            }
          };

          // Watch store.finalText (from Bin) so Home preview can render direct codes
          watch(() => store.state.finalText, (val) => {
            if (val) {
              store.commit('setSelectedOption', '');
              store.commit('setInputText', '');
              nextTick(() => {
                renderQRCode(val);
                JsBarcode(barcodeSvg.value, val, { format: 'CODE128', displayValue: true, width: 2, height: 60 });
                qrPresent.value = true;
                barcodePresent.value = true;
              });
            }
          });

          return {
            qrcodeWrap, barcodeSvg, inputText, selectedOption, computedFinalText, options,
            copyFinal, clearAll, downloadQr, downloadBarcode, qrPresent, barcodePresent, openFullscreen
          };
        }
      };

      // -----------------------
      // BIN component
      // -----------------------
      const Bin = {
        template: `
        <div>
        <div class="bg-youtube" aria-hidden="true">
      <iframe src="https://www.youtube.com/embed/WymKNMXDEpI?autoplay=1&mute=1&controls=0&loop=1&playlist=WymKNMXDEpI&rel=0&showinfo=0" allow="autoplay; encrypted-media" title="Background"></iframe>
    </div>
          <h4 class="mb-3">Bin Color Generator</h4>

          <div class="row gy-3">
            <div class="col-12 col-md-6">
              <div class="card p-3">
                <div class="mb-3"><strong>Pick a color and number</strong></div>

                <div class="d-flex flex-wrap gap-2 mb-2">
                  <button v-for="num in 9" :key="'w'+num" @click="generateCode('WHT', num)" class="btn btn-light num-btn">WHT {{num}}</button>
                  <button v-for="num in 9" :key="'b'+num" @click="generateCode('BLU', num)" class="btn btn-primary num-btn">BLU {{num}}</button>
                  <button v-for="num in 9" :key="'g'+num" @click="generateCode('GRN', num)" class="btn btn-success num-btn">GRN {{num}}</button>
                  <button v-for="num in 9" :key="'y'+num" @click="generateCode('YLW', num)" class="btn btn-warning num-btn">YLW {{num}}</button>
                  <button v-for="num in 9" :key="'r'+num" @click="generateCode('RED', num)" class="btn btn-danger num-btn">RED {{num}}</button>
                </div>

                <div class="small text-muted">Click a button to generate code. Preview on the right.</div>
              </div>
            </div>

            <div class="col-12 col-md-6">
              <div class="card p-3 text-center">
                <h6 class="mb-2">Result</h6>
                <div v-if="finalTextLocal">
                  <div class="fw-semibold mb-2 fs-5">{{ finalTextLocal }}</div>
                  <div id="qrcode-bin" ref="qrcodeBin"></div>
                  <svg ref="barcodeBin" id="barcode-bin"></svg>
                  <div class="mt-3 d-flex gap-2 justify-content-center">
                    <button class="btn btn-sm btn-primary" @click="copyToClipboard"><i class="fa-regular fa-copy me-2"></i>Copy</button>
                    <button class="btn btn-sm btn-success" @click="downloadQrBin"><i class="fa-solid fa-download me-2"></i>Download QR</button>
                  </div>
                </div>
                <div v-else class="text-muted">No code generated yet â€” pick a color + number.</div>
              </div>
            </div>
          </div>
        </div>
        `,
        setup() {
          const qrcodeBin = ref(null);
          const barcodeBin = ref(null);
          const finalTextLocal = ref('');

          // generate QR for bin
          function renderQRBin(text) {
            const el = qrcodeBin.value;
            if (!el) return;
            el.innerHTML = '';
            if (!text) return;
            new QRCode(el, {
              text: text,
              width: Math.min(220, Math.max(120, window.innerWidth * 0.22)),
              height: Math.min(220, Math.max(120, window.innerWidth * 0.22)),
              correctLevel: QRCode.CorrectLevel.H
            });
          }

          function renderBarcodeBin(text) {
            const svg = barcodeBin.value;
            if (!svg) return;
            try {
              JsBarcode(svg, text, {
                format: 'CODE128',
                displayValue: true,
                lineColor: '#000',
                width: 2,
                height: 60,
                margin: 6
              });
            } catch (e) {}
          }

          const generateCode = (color, num) => {
            const code = `${color}_${num}`;
            finalTextLocal.value = code;
            // inform global store (so Home preview can pick it up if needed)
            store.commit('setFinalText', code);
            nextTick(() => {
              renderQRBin(code);
              renderBarcodeBin(code);
            });
          };

          onMounted(() => {
            if (qrcodeBin.value) qrcodeBin.value.innerHTML = '';
            if (barcodeBin.value) barcodeBin.value.innerHTML = '';
          });

          const copyToClipboard = async () => {
            if (!finalTextLocal.value) return alert('Nothing to copy');
            try {
              await navigator.clipboard.writeText(finalTextLocal.value);
              alert('Copied: ' + finalTextLocal.value);
            } catch {
              alert('Copy failed');
            }
          };

          const downloadQrBin = () => {
            const el = qrcodeBin.value;
            if (!el) return alert('QR not found');
            const img = el.querySelector('img') || el.querySelector('canvas');
            if (img && (img.src || img.toDataURL)) {
              const href = img.src || img.toDataURL('image/png');
              const a = document.createElement('a');
              a.href = href;
              a.download = (finalTextLocal.value || 'qr') + '.png';
              a.click();
            } else {
              alert('Unable to export QR yet.');
            }
          };

          return { qrcodeBin, barcodeBin, generateCode, finalTextLocal, copyToClipboard, downloadQrBin };
        }
      };

      // -----------------------
      // ABOUT component
      // -----------------------
      const About = {
        template: `
        <div>
          <h4 class="mb-2">About This App</h4>
          <p class="text-muted">This SPA uses Vue 3, Vuex and Vue Router with JsBarcode and qrcode.js for generating barcodes and QR codes. The UI uses Bootstrap 5 and FontAwesome for icons.</p>
          <ul>
            <li>Home: carousel gallery + QR generator preview</li>
            <li>Bin: color + number quick generator</li>
            <li>Export: copy / download preview</li>
          </ul>
        </div>
        `
      };

      // -----------------------
      // Router
      // -----------------------
      const routes = [
        { path: '/', component: Home },
        { path: '/bin', component: Bin },
        { path: '/about', component: About },
      ];
      const router = createRouter({
        history: createWebHashHistory(),
        routes
      });

      // -----------------------
      // Mount
      // -----------------------
      const app = createApp({});
      app.use(store);
      app.use(router);
      app.mount('#app');

      // Small accessibility tweak: close modal with Escape when open (Bootstrap does this by default)
    })();
  </script>
</body>
</html>
