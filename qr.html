<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Vue SPA - QR & Barcode (Bootstrap 5 UI)</title>

  <!-- Bootstrap 5 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Font Awesome -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

  <!-- Vue / Vuex / Router -->
  <script src="https://unpkg.com/vue@3"></script>
  <script src="https://unpkg.com/vuex@4"></script>
  <script src="https://unpkg.com/vue-router@4"></script>

  <!-- JsBarcode and QRCode -->
  <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

  <style>
    :root{
      --primary:#0d6efd;
      --bg:#f8f9fa;
      --card-radius:14px;
    }

    body{
      background: var(--bg);
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      padding-bottom: 90px; /* leave room for sticky footer on small screens */
    }

    /* Header */
    .app-navbar {
      backdrop-filter: blur(6px);
      background: rgba(255,255,255,0.85);
      box-shadow: 0 6px 18px rgba(12, 13, 14, .06);
      border-bottom: 1px solid rgba(0,0,0,0.04);
    }

    .brand-title {
      font-weight:700;
      letter-spacing:0.2px;
      font-size:1.05rem;
    }

    /* Left slide offcanvas customization - 70% on mobile, 320px on desktop */
    .offcanvas-start.custom-drawer {
      width: 320px;
      max-width: 85%;
    }
    @media (max-width: 720px){
      .offcanvas-start.custom-drawer { width: 70%; }
    }

    .nav-icon-btn {
      width:44px; height:44px; display:inline-flex; align-items:center; justify-content:center;
      border-radius:10px; border:1px solid rgba(0,0,0,0.06); background:white;
    }

    /* Page content container */
    .content-wrap{ max-width:1100px; margin: 20px auto; padding: 12px; }

    /* Cards, QR/Barcode area */
    .card-ui {
      border-radius: var(--card-radius);
      box-shadow: 0 8px 30px rgba(15,23,42,0.06);
      overflow: visible;
    }

    /* Responsive QR & Barcode */
    #qrcode, #qrcode-bin { margin: 10px auto; display:block; }
    svg { display:block; margin: 10px auto; max-width:100%; height:auto; }

    /* Footer sticky */
    .sticky-footer {
      position: fixed;
      bottom: 0;
      left:0;
      right:0;
      background: rgba(255,255,255,0.96);
      border-top: 1px solid rgba(0,0,0,0.06);
      padding: 8px 12px;
      display: flex;
      align-items:center;
      justify-content:center;
      z-index: 1050;
      height:72px;
    }
    .sticky-footer iframe { width:320px; height:52px; border-radius:8px; border:0; }

    /* Carousel box */
    .hero-carousel .carousel-item img{ object-fit:cover; height: 360px; border-radius:12px; }

    /* Utility spacing for small screens */
    @media (max-width: 576px){
      .hero-carousel .carousel-item img{ height: 240px; }
      .brand-title { font-size: 1rem; }
    }

    /* Buttons appearance for bin */
    .num-btn {
      min-width:48px; min-height:48px; border-radius:10px; font-weight:700;
      box-shadow: 0 6px 18px rgba(12,13,14,0.04);
    }

    /* Make router link active visible */
    .nav-link.active{
      background: var(--primary); color: white !important; border-radius:8px;
    }
  </style>
</head>
<body>

  <div id="app">
    <!-- NAVBAR -->
    <header class="app-navbar sticky-top">
      <div class="container">
        <div class="d-flex align-items-center justify-content-between py-2">

          <!-- Left: Drawer toggle -->
          <div class="d-flex align-items-center gap-2">
            <button class="btn p-0" data-bs-toggle="offcanvas" data-bs-target="#leftDrawer" aria-controls="leftDrawer">
              <div class="nav-icon-btn"><i class="fa-solid fa-bars"></i></div>
            </button>
            <!-- optional back/home icon on small screens -->
            <a class="d-none d-md-inline-block ms-2 text-decoration-none text-muted" href="#/">
              <i class="fa-solid fa-house-chimney"></i>
            </a>
          </div>

          <!-- Center: Brand -->
          <div class="text-center flex-grow-1">
            <div class="brand-title">ðŸ“¦ QR & Barcode Studio</div>
            <div class="text-muted small d-none d-md-block">Generate QRs & Code128 barcodes â€” quick, responsive & printable</div>
          </div>

          <!-- Right: Quick links -->
          <div class="d-flex align-items-center gap-2">
            <nav class="d-flex gap-2">
              <router-link to="/" class="nav-link px-2" exact>Home</router-link>
              <router-link to="/bin" class="nav-link px-2">Bin</router-link>
              <router-link to="/about" class="nav-link px-2">About</router-link>
            </nav>
            <a class="btn btn-sm btn-outline-secondary d-none d-lg-inline-flex align-items-center" href="#" role="button">
              <i class="fa-solid fa-download me-2"></i>Export
            </a>
          </div>

        </div>
      </div>
    </header>

    <!-- Offcanvas Left Drawer -->
    <div class="offcanvas offcanvas-start custom-drawer" tabindex="-1" id="leftDrawer" aria-labelledby="leftDrawerLabel">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="leftDrawerLabel"><i class="fa-solid fa-clipboard-list me-2"></i>Menu</h5>
        <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
      </div>
      <div class="offcanvas-body">
        <div class="list-group">
          <router-link to="/" class="list-group-item list-group-item-action"> <i class="fa-solid fa-qrcode me-2"></i>Home - QR/Barcode</router-link>
          <router-link to="/bin" class="list-group-item list-group-item-action"> <i class="fa-solid fa-box-open me-2"></i>Bin Codes</router-link>
          <router-link to="/about" class="list-group-item list-group-item-action"> <i class="fa-solid fa-circle-info me-2"></i>About</router-link>
        </div>

        <hr>

        <h6 class="small text-uppercase text-muted">Quick Tools</h6>
        <div class="d-grid gap-2">
          <button class="btn btn-outline-primary btn-sm"><i class="fa-solid fa-print me-2"></i> Print QR</button>
          <button class="btn btn-outline-success btn-sm"><i class="fa-solid fa-share-nodes me-2"></i> Share</button>
        </div>

        <hr>

        <div class="small text-muted">Made with <i class="fa-solid fa-heart text-danger"></i> â€¢ Responsive</div>
      </div>
    </div>

    <!-- MAIN CONTENT -->
    <main class="content-wrap">

      <div class="row gy-3">
        <div class="col-12">
          <!-- HERO CARD: Carousel -->
          <div class="card card-ui p-3">
            <div class="d-flex justify-content-between align-items-start mb-2">
              <div>
                <h5 class="mb-0">Gallery</h5>
                <small class="text-muted">Auto sliding carousel with controls</small>
              </div>
              <div class="d-flex gap-2">
                <button class="btn btn-sm btn-outline-secondary" data-bs-target="#heroCarousel" data-bs-slide="prev">
                  <i class="fa-solid fa-chevron-left"></i>
                </button>
                <button class="btn btn-sm btn-outline-secondary" data-bs-target="#heroCarousel" data-bs-slide="next">
                  <i class="fa-solid fa-chevron-right"></i>
                </button>
              </div>
            </div>

            <div id="heroCarousel" class="carousel slide hero-carousel" data-bs-ride="carousel" data-bs-interval="3000">
              <div class="carousel-inner rounded-3">
                <div class="carousel-item active">
                  <img src="https://res.cloudinary.com/mandmshop/image/upload/v1762628206/IMG-20251109-WA0001_pqz82h.jpg" class="d-block w-100" alt="img1">
                </div>
                <div class="carousel-item">
                  <img src="https://res.cloudinary.com/mandmshop/image/upload/v1762628444/IMG-20251109-WA0000_blnqcp.jpg" class="d-block w-100" alt="img2">
                </div>
                <div class="carousel-item">
                  <img src="https://res.cloudinary.com/mandmshop/image/upload/v1752402615/IMG_20250713_155653_pal2de.jpg" class="d-block w-100" alt="img3">
                </div>
                <div class="carousel-item">
                  <img src="https://res.cloudinary.com/mandmshop/image/upload/v1761308356/IMG-20251024-WA0013_serib8.jpg" class="d-block w-100" alt="img4">
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Router view -->
        <div class="col-12">
          <div class="card card-ui p-3">
            <router-view></router-view>
          </div>
        </div>
      </div>

    </main>

    <!-- STICKY FOOTER with YouTube iframe -->
    <div class="sticky-footer d-md-none">
      <iframe
        src="https://www.youtube.com/embed/WymKNMXDEpI?autoplay=0&mute=1"
        title="YouTube Shorts"
        allow="autoplay; encrypted-media; gyroscope; picture-in-picture">
      </iframe>
    </div>

    <!-- Larger screen footer -->
    <footer class="d-none d-md-flex justify-content-center align-items-center mt-4 mb-4">
      <iframe
        width="560" height="90"
        src="https://www.youtube.com/embed/WymKNMXDEpI?autoplay=0&mute=1"
        title="YouTube Shorts"
        allow="autoplay; encrypted-media; gyroscope; picture-in-picture"
        allowfullscreen>
      </iframe>
    </footer>
  </div>

  <!-- Bootstrap JS + Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- App Script: Vue, Vuex, Vue Router components (keeps your original logic intact) -->
  <script>
    // using same Vue helpers as original
    const { createApp, ref, computed, watch, onMounted } = Vue;
    const { createStore } = Vuex;
    const { createRouter, createWebHashHistory } = VueRouter;

    // Vuex Store (unchanged logic)
    const store = createStore({
      state() {
        return {
          inputText: '',
          selectedOption: 'HYD_SRB',
          finalText: ''
        };
      },
      mutations: {
        setInputText(state, val) { state.inputText = val; },
        setSelectedOption(state, val) { state.selectedOption = val; },
        setFinalText(state, text) { state.finalText = text; }
      }
    });

    // HOME COMPONENT (UI updated to Bootstrap forms, but logic unchanged)
    const Home = {
      template: `
        <div>
          <div class="row gx-3 gy-3 align-items-center">
            <div class="col-12 col-md-6">
              <h4 class="mb-3">QR & Barcode Generator</h4>

              <div class="mb-2">
                <label class="form-label small">Prefix</label>
                <select class="form-select form-select-sm" v-model="selectedOption">
                  <option v-for="opt in options" :key="opt" :value="opt">{{ opt || '(empty)' }}</option>
                </select>
              </div>

              <div class="mb-2">
                <label class="form-label small">Input text</label>
                <input class="form-control form-control-lg" v-model="inputText" placeholder="Enter text (e.g. 12345)" />
              </div>

              <div class="d-flex gap-2 mt-2">
                <button class="btn btn-primary" @click="copyFinal"><i class="fa-regular fa-copy me-2"></i>Copy</button>
                <button class="btn btn-outline-secondary" @click="clearAll"><i class="fa-solid fa-eraser me-2"></i>Clear</button>
                <button class="btn btn-success" @click="downloadSvg"><i class="fa-solid fa-download me-2"></i>Download QR</button>
              </div>

              <div class="mt-3 small text-muted">
                <strong>Final text:</strong> <span class="fw-semibold">{{ finalText }}</span>
              </div>
            </div>

            <div class="col-12 col-md-6">
              <div class="border rounded-3 p-3 bg-white">
                <h6 class="mb-2">Preview</h6>
                <div class="d-flex flex-column align-items-center">
                  <div id="qrcode" aria-hidden="true"></div>
                  <svg ref="barcode" id="barcode-visual"></svg>
                </div>
                <div class="mt-2 w-100 text-center small text-muted">Tip: Use CODE128 barcodes for scanning with most scanners</div>
              </div>
            </div>
          </div>
        </div>
      `,
      setup() {
        const barcode = ref(null);
        const inputText = computed({
          get: () => store.state.inputText,
          set: val => store.commit('setInputText', val)
        });
        const selectedOption = computed({
          get: () => store.state.selectedOption,
          set: val => store.commit('setSelectedOption', val)
        });
        const finalText = computed(() => (selectedOption.value || '') + (inputText.value || '') );

        const options = [
          'HYD_SRB', 'ZEP_SRB_', '08_SRB_','09_SRB_','10_SRB_',
          'HYD_RB',
          '',
          'HYD_IB','ZEP_IB_','08_IB_', '09_IB_','10_IB_',
          'ZEP_RB_', 
          'ZEP_MIB_','08_MIB_', '09_MIB_', '10_MIB_', 
          'ZEP_IB', 
        ];

        // QR generator
        const generateQRCode = (text) => {
          const qrEl = document.getElementById("qrcode");
          if (qrEl) {
            qrEl.innerHTML = "";
            new QRCode(qrEl, {
              text: text || '',
              width: Math.min(220, Math.max(120, window.innerWidth * 0.25)),
              height: Math.min(220, Math.max(120, window.innerWidth * 0.25)),
              correctLevel: QRCode.CorrectLevel.H
            });
          }
        };

        // watch finalText
        watch(finalText, (newVal) => {
          if (newVal !== undefined) {
            generateQRCode(newVal);
            if (barcode.value) {
              try{
                JsBarcode(barcode.value, newVal || ' ', {
                  format: 'CODE128',
                  displayValue: true,
                  lineColor: '#000',
                  width: 2,
                  height: 60
                });
              }catch(err){
                // ignore invalid barcode data
              }
            }
          }
        }, { immediate: true });

        onMounted(() => {
          if (finalText.value) {
            generateQRCode(finalText.value);
            JsBarcode(barcode.value, finalText.value, {
              format: 'CODE128',
              displayValue: true,
              lineColor: '#000',
              width: 2,
              height: 60
            });
          }
        });

        const copyFinal = () => {
          const text = finalText.value || '';
          navigator.clipboard?.writeText(text).then(()=> {
            const b = new bootstrap.Toast(document.createElement('div'), {});
            // quick feedback - use alert for compatibility:
            alert('Copied: ' + text);
          }).catch(()=> alert('Copy failed'));
        };

        const clearAll = () => {
          store.commit('setInputText', '');
          store.commit('setSelectedOption', options[0]);
          store.commit('setFinalText', '');
        };

        const downloadSvg = () => {
          // export QR as PNG by rendering canvas, simple approach: use qrcode element's img if exists
          const qrEl = document.getElementById('qrcode');
          if (!qrEl) { alert('QR not found'); return; }
          const img = qrEl.querySelector('img') || qrEl.querySelector('canvas');
          if (img && img.src) {
            const a = document.createElement('a');
            a.href = img.src;
            a.download = (finalText.value || 'qr') + '.png';
            a.click();
          } else {
            alert('Unable to export. Try after QR is generated.');
          }
        };

        return { barcode, inputText, selectedOption, options, finalText, copyFinal, clearAll, downloadSvg };
      }
    };

    // BIN COMPONENT (UI styled)
    const Bin = {
      template: `
        <div>
          <h4 class="mb-3">Bin Color Generator</h4>
          <div class="row gy-3">
            <div class="col-12 col-md-6">
              <div class="card p-3">
                <div class="mb-3"><strong>Choose Color & Number</strong></div>

                <div class="mb-3">
                  <div class="d-flex flex-wrap gap-2">
                    <button v-for="num in 9" :key="'w'+num" @click="generateCode('WHT', num)" class="btn btn-light num-btn">WHT {{num}}</button>
                    <button v-for="num in 9" :key="'b'+num" @click="generateCode('BLU', num)" class="btn btn-primary num-btn">BLU {{num}}</button>
                    <button v-for="num in 9" :key="'g'+num" @click="generateCode('GRN', num)" class="btn btn-success num-btn">GRN {{num}}</button>
                    <button v-for="num in 9" :key="'y'+num" @click="generateCode('YLW', num)" class="btn btn-warning num-btn">YLW {{num}}</button>
                    <button v-for="num in 9" :key="'r'+num" @click="generateCode('RED', num)" class="btn btn-danger num-btn">RED {{num}}</button>
                  </div>
                </div>

                <div class="mt-2 small text-muted">Tap a button to generate code, QR & barcode preview will appear on the right.</div>
              </div>
            </div>

            <div class="col-12 col-md-6">
              <div class="card p-3 text-center">
                <h6 class="mb-2">Result</h6>
                <div v-if="finalText">
                  <div class="fw-semibold mb-2 fs-5">{{ finalText }}</div>
                  <div id="qrcode-bin"></div>
                  <svg ref="barcode" id="barcode-bin"></svg>
                </div>
                <div v-else class="text-muted">No code generated yet â€” pick a color + number.</div>
              </div>
            </div>
          </div>
        </div>
      `,
      setup() {
        const barcode = ref(null);
        const finalText = computed(() => store.state.finalText);

        const generateQRCode = (text) => {
          const qrEl = document.getElementById("qrcode-bin");
          if (qrEl) {
            qrEl.innerHTML = "";
            new QRCode(qrEl, {
              text: text,
              width: Math.min(200, Math.max(120, window.innerWidth * 0.22)),
              height: Math.min(200, Math.max(120, window.innerWidth * 0.22)),
              correctLevel: QRCode.CorrectLevel.H
            });
          }
        };

        const generateCode = (color, num) => {
          const code = `${color}_${num}`;
          store.commit('setFinalText', code);
          generateQRCode(code);
          // small timeout to ensure svg present
          setTimeout(()=> {
            if (barcode.value) {
              try{
                JsBarcode(barcode.value, code, {
                  format: 'CODE128',
                  displayValue: true,
                  lineColor: '#000',
                  width: 2,
                  height: 60
                });
              }catch(e){}
            }
          }, 50);
        };

        // When visiting bin, clear previous qr container so multiple QRs don't stack
        onMounted(()=>{
          const el = document.getElementById('qrcode-bin');
          if(el) el.innerHTML = '';
        });

        return { finalText, barcode, generateCode };
      }
    };

    // ABOUT
    const About = {
      template: `
        <div>
          <h4 class="mb-2">About This App</h4>
          <p class="text-muted">This SPA uses Vue 3, Vuex and Vue Router with JsBarcode and qrcode.js for generating barcodes and QR codes. The UI has been upgraded using Bootstrap 5 and FontAwesome for icons.</p>
          <ul>
            <li>Home: text + dropdown prefix -> QR & CODE128 barcode preview</li>
            <li>Bin: color + number quick generator</li>
            <li>Export: copy / download preview (basic)</li>
          </ul>
        </div>
      `
    };

    // ROUTES
    const routes = [
      { path: '/', component: Home },
      { path: '/bin', component: Bin },
      { path: '/about', component: About }
    ];
    const router = createRouter({
      history: createWebHashHistory(),
      routes
    });

    // MOUNT APP
    const app = createApp({});
    app.use(store);
    app.use(router);
    app.mount('#app');
  </script>
</body>
</html>
