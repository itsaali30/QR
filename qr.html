<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Vue SPA - QR & Barcode (UI Rewrite)</title>

  <!-- Bootstrap 5 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Font Awesome -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

  <!-- Vue / Vuex / Router -->
  <script src="https://unpkg.com/vue@3"></script>
  <script src="https://unpkg.com/vuex@4"></script>
  <script src="https://unpkg.com/vue-router@4"></script>

  <!-- JsBarcode and QRCode -->
  <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

  <style>
    :root{
      --primary: #0d6efd;
      --bg: #f6f8fb;
      --card-radius: 12px;
    }

    html,body {
      height: 100%;
      background: var(--bg);
      margin: 0;
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    /* Navbar */
    .app-navbar {
      backdrop-filter: blur(6px);
      background: rgba(255,255,255,0.92);
      border-bottom: 1px solid rgba(0,0,0,0.04);
      box-shadow: 0 6px 18px rgba(12, 13, 14, .04);
    }
    .brand-title { font-weight: 700; font-size: 1.05rem; }

    /* Offcanvas drawer width */
    .offcanvas-start.custom-drawer { width: 300px; max-width: 85%; }

    /* Content container keeps room for sticky footer */
    .main-container {
      max-width: 1100px;
      margin: 22px auto;
      padding: 12px;
      padding-bottom: 120px; /* leave space for sticky footer */
    }

    .card-ui {
      border-radius: var(--card-radius);
      box-shadow: 0 8px 30px rgba(15,23,42,0.04);
    }

    /* Gallery */
    .gallery-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
    }
    @media (max-width: 900px) {
      .gallery-grid { grid-template-columns: repeat(2, 1fr); }
    }
    @media (max-width: 520px) {
      .gallery-grid { grid-template-columns: 1fr; }
    }
    .gallery-img {
      width: 100%; height: 220px; object-fit: cover; border-radius: 10px;
      box-shadow: 0 6px 20px rgba(10,10,10,0.06);
      transition: transform .22s ease, box-shadow .22s ease;
    }
    .gallery-img:hover { transform: translateY(-6px); box-shadow: 0 14px 34px rgba(10,10,10,0.12); }

    /* QR & Barcode preview area */
    #qrcode, #qrcode-bin { margin: 8px auto; display:block; }
    svg { display:block; margin: 8px auto; max-width:100%; height:auto; }

    /* Sticky footer iframe */
    .sticky-footer {
      position: fixed;
      left: 0;
      right: 0;
      bottom: 0;
      height: 88px;
      background: rgba(255,255,255,0.96);
      border-top: 1px solid rgba(0,0,0,0.06);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1200;
      padding: 8px;
    }
    .sticky-footer .iframe-wrap {
      width: 340px;
      height: 70px;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 8px 30px rgba(15,23,42,0.06);
      border: 1px solid rgba(0,0,0,0.04);
    }
    @media (min-width: 992px) {
      .sticky-footer .iframe-wrap { width: 560px; height: 80px; }
    }

    /* Small utility */
    .num-btn { min-width: 48px; min-height: 44px; border-radius: 10px; font-weight: 700; }
    .nav-link.active { background: var(--primary); color: white !important; border-radius: 8px; }

    /* tweak for router view card */
    .router-card { padding: 18px; background: white; border-radius: 12px; }

    /* make sure content doesn't hide behind footer on very small screens */
    @media (max-height: 600px) {
      .main-container { padding-bottom: 160px; }
    }
  </style>
</head>
<body>
  <div id="app">
    <!-- NAVBAR -->
    <header class="app-navbar sticky-top">
      <div class="container">
        <div class="d-flex align-items-center justify-content-between py-2">
          <!-- Left: Drawer toggle -->
          <div class="d-flex align-items-center gap-2">
            <button class="btn p-0" data-bs-toggle="offcanvas" data-bs-target="#leftDrawer" aria-controls="leftDrawer">
              <div style="width:44px;height:44px;border-radius:10px;background:white;display:flex;align-items:center;justify-content:center;border:1px solid rgba(0,0,0,0.06);">
                <i class="fa-solid fa-bars"></i>
              </div>
            </button>
            <a class="text-decoration-none ms-2 d-none d-md-inline-block text-muted" href="#/">
              <i class="fa-solid fa-house-chimney"></i>
            </a>
          </div>

          <!-- Center brand -->
          <div class="text-center flex-grow-1">
            <div class="brand-title">ðŸ“¦ QR & Barcode Studio</div>
            <div class="text-muted small d-none d-md-block">Quickly create QR & CODE128 barcodes â€” responsive & printable</div>
          </div>

          <!-- Right: links -->
          <div class="d-flex align-items-center gap-2">
            <nav class="d-flex gap-2">
              <router-link to="/" class="nav-link px-2" exact>Home</router-link>
              <router-link to="/bin" class="nav-link px-2">Bin</router-link>
              <router-link to="/about" class="nav-link px-2">About</router-link>
            </nav>
            <button class="btn btn-outline-secondary d-none d-lg-inline-flex align-items-center">
              <i class="fa-solid fa-download me-2"></i>Export
            </button>
          </div>
        </div>
      </div>
    </header>

    <!-- OFFCANVAS LEFT -->
    <div class="offcanvas offcanvas-start custom-drawer" tabindex="-1" id="leftDrawer" aria-labelledby="leftDrawerLabel">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="leftDrawerLabel"><i class="fa-solid fa-clipboard-list me-2"></i>Menu</h5>
        <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
      </div>
      <div class="offcanvas-body">
        <div class="list-group mb-3">
          <router-link to="/" class="list-group-item list-group-item-action"> <i class="fa-solid fa-qrcode me-2"></i>Home - Gallery</router-link>
          <router-link to="/bin" class="list-group-item list-group-item-action"> <i class="fa-solid fa-box-open me-2"></i>Bin Codes</router-link>
          <router-link to="/about" class="list-group-item list-group-item-action"> <i class="fa-solid fa-circle-info me-2"></i>About</router-link>
        </div>

        <h6 class="small text-uppercase text-muted mb-2">Tools</h6>
        <div class="d-grid gap-2 mb-3">
          <button class="btn btn-outline-primary btn-sm"><i class="fa-solid fa-print me-2"></i>Print QR</button>
          <button class="btn btn-outline-success btn-sm"><i class="fa-solid fa-share-nodes me-2"></i>Share</button>
        </div>

        <div class="small text-muted">Made with <i class="fa-solid fa-heart text-danger"></i> â€” Responsive UI</div>
      </div>
    </div>

    <!-- MAIN CONTENT -->
    <main class="main-container">
      <div class="row gy-3">
        <!-- Router view content card -->
        <div class="col-12">
          <div class="router-card card-ui">
            <router-view></router-view>
          </div>
        </div>
      </div>
    </main>

    <!-- STICKY FOOTER: fixed bottom iframe -->
    <div class="sticky-footer" role="contentinfo" aria-hidden="false">
      <div class="iframe-wrap">
        <iframe
          src="https://www.youtube.com/embed/WymKNMXDEpI?autoplay=0&mute=1"
          title="YouTube Shorts"
          allow="autoplay; encrypted-media; gyroscope; picture-in-picture"
          style="width:100%;height:100%;border:0;">
        </iframe>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS bundle -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- App Script: Vue, Vuex, Vue Router components (logic preserved) -->
  <script>
    const { createApp, ref, computed, watch, onMounted } = Vue;
    const { createStore } = Vuex;
    const { createRouter, createWebHashHistory } = VueRouter;

    // Vuex Store (KEEPING LOGIC)
    const store = createStore({
      state() {
        return {
          inputText: '',
          selectedOption: 'HYD_SRB',
          finalText: ''
        };
      },
      mutations: {
        setInputText(state, val) { state.inputText = val; },
        setSelectedOption(state, val) { state.selectedOption = val; },
        setFinalText(state, text) { state.finalText = text; }
      }
    });

    // HOME component â€” gallery visible here only, plus QR/Barcode controls kept
    const Home = {
      template: `
        <div>
          <div class="row gy-3">
            <!-- Top: Controls & Preview -->
            <div class="col-12 col-lg-6">
              <h4 class="mb-3">QR & Barcode Generator</h4>

              <div class="mb-2">
                <label class="form-label small">Prefix</label>
                <select class="form-select form-select-sm" v-model="selectedOption">
                  <option v-for="opt in options" :key="opt" :value="opt">{{ opt || '(empty)' }}</option>
                </select>
              </div>

              <div class="mb-2">
                <label class="form-label small">Input text</label>
                <input class="form-control form-control-lg" v-model="inputText" placeholder="Enter text (e.g. 12345)" />
              </div>

              <div class="d-flex gap-2 mt-2">
                <button class="btn btn-primary" @click="copyFinal"><i class="fa-regular fa-copy me-2"></i>Copy</button>
                <button class="btn btn-outline-secondary" @click="clearAll"><i class="fa-solid fa-eraser me-2"></i>Clear</button>
                <button class="btn btn-success" @click="downloadQr"><i class="fa-solid fa-download me-2"></i>Download QR</button>
              </div>

              <div class="mt-3 small text-muted">
                <strong>Final text:</strong> <span class="fw-semibold">{{ finalText }}</span>
              </div>
            </div>

            <!-- Preview -->
            <div class="col-12 col-lg-6">
              <div class="border rounded-3 p-3 bg-white text-center">
                <h6 class="mb-2">Preview</h6>
                <div id="qrcode"></div>
                <svg ref="barcode" id="barcode-visual"></svg>
                <div class="mt-2 small text-muted">CODE128 â€” best for scanners</div>
              </div>
            </div>

            <!-- Gallery (only on Home) -->
            <div class="col-12">
              <div class="mt-3 p-3 bg-white rounded-3 card-ui">
                <div class="d-flex justify-content-between align-items-center mb-3">
                  <div>
                    <h5 class="mb-0">Gallery</h5>
                    <small class="text-muted">Images â€” only shown on Home</small>
                  </div>
                </div>

                <div class="gallery-grid">
                  <img class="gallery-img" src="https://res.cloudinary.com/mandmshop/image/upload/v1762628206/IMG-20251109-WA0001_pqz82h.jpg" alt="g1">
                  <img class="gallery-img" src="https://res.cloudinary.com/mandmshop/image/upload/v1762628444/IMG-20251109-WA0000_blnqcp.jpg" alt="g2">
                  <img class="gallery-img" src="https://res.cloudinary.com/mandmshop/image/upload/v1752402615/IMG_20250713_155653_pal2de.jpg" alt="g3">
                  <img class="gallery-img" src="https://res.cloudinary.com/mandmshop/image/upload/v1761308356/IMG-20251024-WA0013_serib8.jpg" alt="g4">
                  <img class="gallery-img" src="https://res.cloudinary.com/mandmshop/image/upload/v1762628206/IMG-20251109-WA0001_pqz82h.jpg" alt="g5">
                  <img class="gallery-img" src="https://res.cloudinary.com/mandmshop/image/upload/v1762628444/IMG-20251109-WA0000_blnqcp.jpg" alt="g6">
                </div>
              </div>
            </div>
          </div>
        </div>
      `,
      setup() {
        const barcode = ref(null);
        const inputText = computed({
          get: () => store.state.inputText,
          set: val => store.commit('setInputText', val)
        });
        const selectedOption = computed({
          get: () => store.state.selectedOption,
          set: val => store.commit('setSelectedOption', val)
        });
        const finalText = computed(() => (selectedOption.value || '') + (inputText.value || '') );

        const options = [
          'HYD_SRB', 'ZEP_SRB_', '08_SRB_','09_SRB_','10_SRB_',
          'HYD_RB',
          '',
          'HYD_IB','ZEP_IB_','08_IB_', '09_IB_','10_IB_',
          'ZEP_RB_', 
          'ZEP_MIB_','08_MIB_', '09_MIB_', '10_MIB_', 
          'ZEP_IB', 
        ];

        const generateQRCode = (text) => {
          const qrEl = document.getElementById("qrcode");
          if (qrEl) {
            qrEl.innerHTML = "";
            new QRCode(qrEl, {
              text: text || '',
              width: Math.min(220, Math.max(120, window.innerWidth * 0.24)),
              height: Math.min(220, Math.max(120, window.innerWidth * 0.24)),
              correctLevel: QRCode.CorrectLevel.H
            });
          }
        };

        watch(finalText, (newVal) => {
          if (newVal !== undefined) {
            generateQRCode(newVal);
            if (barcode.value) {
              try{
                JsBarcode(barcode.value, newVal || ' ', {
                  format: 'CODE128',
                  displayValue: true,
                  lineColor: '#000',
                  width: 2,
                  height: 60
                });
              }catch(err){}
            }
          }
        }, { immediate: true });

        onMounted(() => {
          if (finalText.value) {
            generateQRCode(finalText.value);
            try {
              JsBarcode(barcode.value, finalText.value, {
                format: 'CODE128',
                displayValue: true,
                lineColor: '#000',
                width: 2,
                height: 60
              });
            } catch(e){}
          }
        });

        const copyFinal = () => {
          const text = finalText.value || '';
          navigator.clipboard?.writeText(text).then(()=> alert('Copied: ' + text)).catch(()=> alert('Copy failed'));
        };

        const clearAll = () => {
          store.commit('setInputText', '');
          store.commit('setSelectedOption', options[0]);
          store.commit('setFinalText', '');
          const el = document.getElementById('qrcode');
          if (el) el.innerHTML = '';
          const el2 = document.getElementById('qrcode-bin');
          if (el2) el2.innerHTML = '';
        };

        const downloadQr = () => {
          const qrEl = document.getElementById('qrcode');
          if (!qrEl) { alert('QR not found'); return; }
          const img = qrEl.querySelector('img') || qrEl.querySelector('canvas');
          if (img && img.src) {
            const a = document.createElement('a');
            a.href = img.src;
            a.download = (finalText.value || 'qr') + '.png';
            a.click();
          } else {
            alert('Unable to export. Try after QR is generated.');
          }
        };

        return { barcode, inputText, selectedOption, options, finalText, copyFinal, clearAll, downloadQr };
      }
    };

    // BIN Component (UI updated)
    const Bin = {
      template: `
        <div>
          <h4 class="mb-3">Bin Color Generator</h4>

          <div class="row gy-3">
            <div class="col-12 col-md-6">
              <div class="card p-3">
                <div class="mb-3"><strong>Pick a color and number</strong></div>

                <div class="d-flex flex-wrap gap-2 mb-2">
                  <button v-for="num in 9" :key="'w'+num" @click="generateCode('WHT', num)" class="btn btn-light num-btn">WHT {{num}}</button>
                  <button v-for="num in 9" :key="'b'+num" @click="generateCode('BLU', num)" class="btn btn-primary num-btn">BLU {{num}}</button>
                  <button v-for="num in 9" :key="'g'+num" @click="generateCode('GRN', num)" class="btn btn-success num-btn">GRN {{num}}</button>
                  <button v-for="num in 9" :key="'y'+num" @click="generateCode('YLW', num)" class="btn btn-warning num-btn">YLW {{num}}</button>
                  <button v-for="num in 9" :key="'r'+num" @click="generateCode('RED', num)" class="btn btn-danger num-btn">RED {{num}}</button>
                </div>

                <div class="small text-muted">Click a button to generate code. Preview on the right.</div>
              </div>
            </div>

            <div class="col-12 col-md-6">
              <div class="card p-3 text-center">
                <h6 class="mb-2">Result</h6>
                <div v-if="finalText">
                  <div class="fw-semibold mb-2 fs-5">{{ finalText }}</div>
                  <div id="qrcode-bin"></div>
                  <svg ref="barcode" id="barcode-bin"></svg>
                </div>
                <div v-else class="text-muted">No code generated yet â€” pick a color + number.</div>
              </div>
            </div>
          </div>
        </div>
      `,
      setup() {
        const barcode = ref(null);
        const finalText = computed(() => store.state.finalText);

        const generateQRCode = (text) => {
          const qrEl = document.getElementById("qrcode-bin");
          if (qrEl) {
            qrEl.innerHTML = "";
            new QRCode(qrEl, {
              text: text,
              width: Math.min(200, Math.max(120, window.innerWidth * 0.22)),
              height: Math.min(200, Math.max(120, window.innerWidth * 0.22)),
              correctLevel: QRCode.CorrectLevel.H
            });
          }
        };

        const generateCode = (color, num) => {
          const code = `${color}_${num}`;
          store.commit('setFinalText', code);
          generateQRCode(code);
          setTimeout(()=> {
            if (barcode.value) {
              try{
                JsBarcode(barcode.value, code, {
                  format: 'CODE128',
                  displayValue: true,
                  lineColor: '#000',
                  width: 2,
                  height: 60
                });
              }catch(e){}
            }
          }, 50);
        };

        onMounted(()=> {
          const el = document.getElementById('qrcode-bin');
          if (el) el.innerHTML = '';
        });

        return { finalText, barcode, generateCode };
      }
    };

    // ABOUT
    const About = {
      template: `
        <div>
          <h4 class="mb-2">About This App</h4>
          <p class="text-muted">This SPA uses Vue 3, Vuex and Vue Router with JsBarcode and qrcode.js for generating barcodes and QR codes. The UI is rebuilt with Bootstrap 5 and FontAwesome for icons.</p>
          <ul>
            <li>Home: gallery + QR generator preview</li>
            <li>Bin: color + number quick generator</li>
            <li>Export: copy / download preview (basic)</li>
          </ul>
        </div>
      `
    };

    // ROUTES
    const routes = [
      { path: '/', component: Home },
      { path: '/bin', component: Bin },
      { path: '/about', component: About }
    ];
    const router = createRouter({
      history: createWebHashHistory(),
      routes
    });

    // MOUNT APP
    const app = createApp({});
    app.use(store);
    app.use(router);
    app.mount('#app');
  </script>
</body>
</html>
