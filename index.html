<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Vue SPA - QR & Barcode</title>
  <script src="https://unpkg.com/vue@3"></script>
  <script src="https://unpkg.com/vuex@4"></script>
  <script src="https://unpkg.com/vue-router@4"></script>
  <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <style>
    body { font-family: sans-serif; text-align: center; padding: 30px; background: #f5f5f5; }
    .color-buttons { margin: 20px 0; }
    .color-btn {
      margin: 10px;
      padding: 15px 30px;
      font-size: 1.2em;
      font-weight: bold;
      border: 3px solid #333;
      border-radius: 8px;
      cursor: pointer;
      transition: transform 0.2s;
    }
    .color-btn:hover { transform: scale(1.1); }
    .color-btn:active { transform: scale(0.95); }
    .btn-wht { background: white; color: black; }
    .btn-blu { background: #2196F3; color: white; }
    .btn-grn { background: #4CAF50; color: white; }
    .btn-ylw { background: #FFEB3B; color: black; }
    .btn-red { background: #F44336; color: white; }
    svg, #qrcode { margin-top: 20px; }
    #qrcode { margin: 20px auto; width: fit-content; }
    nav a { margin: 0 10px; text-decoration: none; color: blue; }
    nav a.router-link-exact-active { font-weight: bold; color: black; }
    .output-container { background: white; padding: 20px; border-radius: 10px; margin-top: 20px; }
  </style>
</head>
<body>
  <div id="app">
    <nav>
      <router-link to="/">Home</router-link>
      <router-link to="/about">About</router-link>
    </nav>
    <router-view></router-view>
  </div>

  <script>
    const { createApp, ref, computed, watch } = Vue;
    const { createStore } = Vuex;
    const { createRouter, createWebHashHistory } = VueRouter;

    // Vuex Store
    const store = createStore({
      state() {
        return {
          currentColor: '',
          currentNumber: 0,
          finalText: ''
        };
      },
      mutations: {
        generateCode(state, color) {
          state.currentColor = color;
          state.currentNumber = (state.currentNumber % 9) + 1;
          state.finalText = `${color}_${state.currentNumber}`;
        }
      }
    });

    // Home Page
    const Home = {
      template: `
        <div>
          <h2>QR & Barcode Color Generator</h2>
          
          <div class="color-buttons">
            <button class="color-btn btn-wht" @click="generateCode('WHT')">WHT</button>
            <button class="color-btn btn-blu" @click="generateCode('BLU')">BLU</button>
            <button class="color-btn btn-grn" @click="generateCode('GRN')">GRN</button>
            <button class="color-btn btn-ylw" @click="generateCode('YLW')">YLW</button>
            <button class="color-btn btn-red" @click="generateCode('RED')">RED</button>
          </div>

          <div v-if="finalText" class="output-container">
            <h3>Generated Code: <strong>{{ finalText }}</strong></h3>
            
            <h3>QR Code</h3>
            <div id="qrcode"></div>

            <h3>Barcode</h3>
            <svg ref="barcode"></svg>
          </div>
        </div>
      `,
      setup() {
        const barcode = ref(null);
        const finalText = computed(() => store.state.finalText);
        const colorCounters = ref({
          WHT: 0,
          BLU: 0,
          GRN: 0,
          YLW: 0,
          RED: 0
        });

        const generateCode = (color) => {
          colorCounters.value[color] = (colorCounters.value[color] % 9) + 1;
          const code = `${color}_${colorCounters.value[color]}`;
          store.state.finalText = code;
          
          generateQRCode(code);
          if (barcode.value) {
            JsBarcode(barcode.value, code, {
              format: 'CODE128',
              displayValue: true,
              lineColor: '#000',
              width: 2,
              height: 80
            });
          }
        };

        const generateQRCode = (text) => {
          const qrEl = document.getElementById("qrcode");
          if (qrEl) {
            qrEl.innerHTML = "";
            new QRCode(qrEl, {
              text: text,
              width: 150,
              height: 150,
              correctLevel: QRCode.CorrectLevel.H
            });
          }
        };

        return { finalText, barcode, generateCode };
      }
    };

    // About Page
    const About = {
      template: `
        <div>
          <h2>About This App</h2>
          <p>Click color buttons to generate QR codes and barcodes.</p>
          <p>Each color maintains its own counter from 1 to 9.</p>
        </div>
      `
    };

    // Router
    const routes = [
      { path: '/', component: Home },
      { path: '/about', component: About }
    ];

    const router = createRouter({
      history: createWebHashHistory(),
      routes
    });

    // App
    const app = createApp({});
    app.use(store);
    app.use(router);
    app.mount('#app');
  </script>
</body>
</html>
